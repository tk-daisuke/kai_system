# Co-worker Bot マニュアル (v1.0)

## 1. 概要
本ツールは、社内の定型業務（WebからのCSVダウンロードと業務Excelへの転記）を自動化するロボットです。
指定された時間帯やタスクごとに、自動的に必要な処理を行います。

## 2. 起動方法

### 通常起動（本番モード）
1.  `src/main.py` を実行（または配布された `Co-worker_Bot.exe` をダブルクリック）します。
2.  起動直後に「注意事項」のポップアップが表示されます。
    *   ブラウザが自動的に開きます。業務サイトにログイン済みであることを確認してください。
    *   **重要**: 実行中はコピー＆ペースト（クリップボード操作）を行わないでください。
3.  グループ選択画面が表示されます。

### テストモード
開発や設定変更時のテスト用です。
コマンドラインから以下を実行します。
```powershell
python src/main.py --env=test
```
※ `settings/test/Task_Master.xlsx` が読み込まれます。

## 3. 設定ファイルについて

設定ファイル (`Task_Master.xlsx`) は以下の順序で記述されています。編集時はこのフォーマットに従ってください。

| 列名 | 必須 | 説明 |
|:---|:---:|:---|
| **Active** | 〇 | `TRUE` で有効、`FALSE` で無効（スキップ）。一時的に止めたい場合は FALSE にします。 |
| **Group** | 〇 | 業務グループ名（例:`08:00業務`）。アプリ上のボタン名になります。 |
| **Memo** | | メモ用（プログラムは無視します）。備考などを自由に入力してください。 |
| **StartTime** | 〇 | 実行開始時刻（HH:MM）。この時刻より前には実行されません。 |
| **EndTime** | 〇 | 実行期限（HH:MM）。この時刻を過ぎている場合は、安全のためスキップされます。 |
| **FilePath** | 〇 | 操作対象のExcelファイルのフルパス。 |
| **TargetSheet** | 〇 | データを貼り付けるシート名。 |
| **DownloadURL** | 〇 | CSVダウンロードWebサイトのURL。 |
| **SearchKey** | 〇 | ダウンロードファイルを特定するためのキーワード（ファイル名に含まれる文字）。 |
| **ActionAfter** | 〇 | 完了後の動作。`Save`（保存終了）または `Pause`（一時停止して確認）。 |

## 4. やり直し機能

処理が途中でエラーになった場合や、特定のタスクだけ再実行したい場合に使用します。

1.  画面下部のドロップダウンから再開したいタスクを選択します。
2.  **実行ボタンを選択**:
    *   **「ここから実行」**: 選んだタスク **以降の、同じグループのタスク** をすべて順次実行します。
    *   **「このタスクのみ」**: 選んだタスクだけを単発で実行します。

※ この機能を使うと、StartTime/EndTimeの制限を無視して **強制実行** されます。

## 5. トラブルシューティング

### Q. ブラウザが開くが、ログイン画面が表示される
A. 自動ログイン機能はありません。お手数ですが、実行前に手動でログインを済ませてください。

### Q. 「ファイルが見つかりません」エラーが出る
A. `FilePath` のパスが正しいか、ネットワークドライブに接続できているか確認してください。

### Q. エラーで止まったが、何が原因かわからない
A. `logs` フォルダにある `log_YYYYMMDD.txt` を確認してください。詳細なエラー内容が記録されています。

### Q. Windowsをロック（Win+L）したままでも動きますか？
A. **推奨しません。**
Excelやブラウザは画面描画が必要な場合があり、ロック状態では処理が停止したりエラーになる可能性が高いです。実行中はロックを避けるか、少なくとも動作確認ができる状態を維持してください。

### Q. 途中で止めたい（休憩したい）場合は？
A. 実行中に有効になる「**⏸ 一時停止**」ボタンを押してください。
現在のタスクが完了したタイミングで一時停止状態（待機中）になります。
この状態であれば、Excel操作が行われないため、**Windowsをロックして離席しても安全です**。
再開する場合は「**▶ 再開**」ボタンを押してください。
